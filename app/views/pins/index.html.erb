<div class="panel panel-default">

  <div class="panel-heading">
    <h1>Listing pins</h1>
  </div>
  <br />

  <div class="panel-body">
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>Image</th>
            <th>Description</th>
            <th>User ID</th>
            <th colspan="1"></th>
          </tr>
        </thead>


        <tbody>
          <!-- 
           - @pins variable set in pins_controller.rb
           - .each is the method we are calling on the funct @pins 
           - .each will run a loop between 'do' and 'end'
           - so this will create a row in the table for each |pin|
           - pin = is the same as pin_path(pin) = path to that pin
           - destroy = same as pin but with method: :delete
           - confirm: 'are you sure?' is the generic popup
          -->

              
              <% @pins.each do |pin| %>
            <tr>
              <td><%= image_tag pin.image.url( :medium) %></td>
              <td><%= pin.description %></td>
              <!-- if functions means it will only show pin.user.email if pin.user is true, that is, if the pin has a user. Otherwise it will be blank -->
              <td><%= pin.user.email if pin.user %></td>

                <td>
                  <%= link_to 'Show', pin, class:"btn btn-success btn-sm" %>
                  <!-- only show edit and destroy buttons if pin user is the logged in user. This next line is true if pin.user is current_user -->
                  <% if pin.user == current_user %>
                    <%= link_to 'Edit', edit_pin_path(pin),  class:"btn btn-info btn-sm" %>
                    <%= link_to 'Destroy', pin,  class:"btn btn-danger btn-sm", method: :delete, data: { confirm: 'Are you sure Bro?' } %>
                  <% end %>
                </td>

              </tr>
      



          <% end %>
        </tbody>
      </table>
    </div>
  </div>

<br>
  <% if user_signed_in? %>
    <div class="panel-footer">
      <%= link_to 'New Pin', new_pin_path, class:"btn btn-danger" %>
    </div>
  <% end %>

</div>